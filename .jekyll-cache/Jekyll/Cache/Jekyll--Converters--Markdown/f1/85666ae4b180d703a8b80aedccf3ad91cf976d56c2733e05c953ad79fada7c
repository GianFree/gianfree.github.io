I"N|<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<h3 id="welcome-to-our-first-tutorial">Welcome to our first tutorial!</h3>

<p>In this session we will learn the basic of visualising a protein,
play with it and a recap of what you will need.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup></p>

<h3 id="overview">Overview</h3>

<p>Practically, the machinery we are going to use can be exemplified
in the following way.</p>

<p><img class="displayed" src="../../img/tut1/md_machinery.png" alt="" /></p>

<p>In a nutshell, the ingredients we need are:</p>
<ul>
  <li>the coordinates of the system;</li>
  <li>the structure of the protein, related to the force field we use;</li>
  <li>the force field parameters for the interactions;</li>
  <li>a configuration file with the appropriate settings of the used algorithms;</li>
  <li>a software to integrate the Newton’s equations;</li>
  <li>the trajectory: a collection of coordinates that follow the evolution of the system.</li>
</ul>

<p>We will rapidly see some of the files in this lesson, but
keep in mind this scheme, since it will be useful later!</p>

<h1 id="software">Software</h1>
<p>Let’s start from the basic. For this tutorial we will use <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a>, a visualisation program
that will allow us to render pretty images and analyse our simulations as well.
The computers provided to you already have VMD installed.
If you want the software on your own laptop, you can download it from <a href="https://www.ks.uiuc.edu/Development/Download/download.cgi?PackageName=VMD">download VMD</a>
with a simple registration. Choose the version <code class="language-plaintext highlighter-rouge">1.9.3</code> suitable for your operating system.</p>

<h1 id="bash">Bash</h1>
<p>The <em>Bourne Again SHell</em> (bash) is a command-line interpreter that allows us to execute commands via text instructions. Let’s have a quick overview of the basic of <code class="language-plaintext highlighter-rouge">bash</code> in the meanwhile.</p>

<p>On Ubuntu type <code class="language-plaintext highlighter-rouge">ctrl-alt-T</code> in order to open a terminal. For macOS, you should find the <strong>Terminal</strong> in the <em>Applications/</em> folder.
For Windows users, use the lab computers.</p>

<p>To check what <code class="language-plaintext highlighter-rouge">bash</code> you are using, type <code class="language-plaintext highlighter-rouge">which bash</code>. You should see something like</p>
<p class="prompt prompt-shell">/bin/bash <br /> /usr/bin/bash</p>

<p>Let’s have a walk into the computer filesystem. First of all, type <code class="language-plaintext highlighter-rouge">pwd</code> (<strong>p</strong>rint <strong>w</strong>orking <strong>d</strong>irectory). The output should be something like:</p>
<p class="prompt prompt-shell"> /home/your_username </p>

<p>What is inside your folder? Type <code class="language-plaintext highlighter-rouge">ls</code> (<strong>l</strong>i<strong>s</strong>t) and read the output.</p>
<p class="prompt prompt-question">What changes if you type “ls -lh”? (without “”)</p>

<p>Let’s create now a new directory for the course.</p>
<p class="prompt prompt-shell">$ mkdir QCB_course</p>
<p class="prompt prompt-attention">Bash does not like white spaces, so use the underscore <code class="language-plaintext highlighter-rouge">_</code>.</p>

<p>With <code class="language-plaintext highlighter-rouge">pwd</code> we can see that we are still in the <code class="language-plaintext highlighter-rouge">/home</code> directory. Try!</p>

<p>Let’s go inside
<code class="language-plaintext highlighter-rouge">QCB_course</code>.</p>
<p class="prompt prompt-shell">$ cd QCB_course</p>

<p>To create an empty file, you can use <code class="language-plaintext highlighter-rouge">touch dummy_file.sh</code>. We will see in a minute
what the extension <code class="language-plaintext highlighter-rouge">.sh</code> means.</p>

<p>We have no interest in the <code class="language-plaintext highlighter-rouge">dummy_file.sh</code>, so we can <strong>r</strong>e<strong>m</strong>ove it with:</p>
<p class="prompt prompt-shell">$ rm dummy_file.sh</p>
<p>Of course, we are all smart, but in order to avoid unwanted deletion, let’s add a
small command to your <code class="language-plaintext highlighter-rouge">~/.bashrc</code> (the <code class="language-plaintext highlighter-rouge">.</code> at the beginning of a filename makes it “invisible”).
First, let’s make a backup copy of the file:</p>
<p class="prompt prompt-shell">$ cd #to go into the home folder <br />
$ cp .bashrc .OLD_bashrc</p>
<p>Guess what <code class="language-plaintext highlighter-rouge">cp</code> does.</p>

<p>Finally we can add our line:</p>
<p class="prompt prompt-shell">$ echo “alias rm=’rm -i’” » .bashrc </p>
<p>If we go into <code class="language-plaintext highlighter-rouge">~/QCB_course</code> folder, create a new file and remove it, we should be
asked for confirm. Right? (Do the same on a new terminal or type <code class="language-plaintext highlighter-rouge">source .bashrc</code>)</p>

<p>With <code class="language-plaintext highlighter-rouge">bash</code> we can perform some basic arithmetics.
Create a new file called <code class="language-plaintext highlighter-rouge">my_script.sh</code> and open it with a text editor.</p>
<p class="prompt prompt-attention">Try to use an editor like ViM, Emacs or nano (without a GUI)</p>

<p>Write the following text into the file and try to understand what it does:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span>5
<span class="k">for </span>j <span class="k">in</span> <span class="o">{</span>1..4<span class="o">}</span>
<span class="k">do
  </span><span class="nb">echo</span> <span class="s2">"Adding 1 to </span><span class="nv">$j</span><span class="s2">: </span><span class="k">$((</span>j <span class="o">+</span> <span class="m">1</span><span class="k">))</span><span class="s2">"</span>
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"Math (should) work! 5*4 = </span><span class="k">$((</span>i<span class="o">*</span>j<span class="k">))</span><span class="s2">"</span>

</code></pre></div></div>

<p>To launch this script:</p>
<p class="prompt prompt-shell">$ bash my_script.sh </p>
<p>You can also launch the commands with <code class="language-plaintext highlighter-rouge">./my_script.sh</code>, if your file is an executable.
List the content of your folder and then do:</p>
<p class="prompt prompt-shell">$ chmod 700 my_script.sh</p>
<p>If you “list” again, did somethin change?</p>

<p class="prompt prompt-attention"> bash is not the only shell you have on your computer! </p>

<p>To further learn about <code class="language-plaintext highlighter-rouge">bash</code>, feel free to search it on <a href="www.google.it">Google</a>.</p>

<h1 id="installing-vmd-optional">Installing VMD (optional)</h1>
<p>Extract the folder, run the configuration, go into the <code class="language-plaintext highlighter-rouge">src/</code> folder and install VMD.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>Downloads/
<span class="nb">tar </span>xvzf VMD_something.tar.gz
<span class="nb">cd </span>VMD_something
./config
<span class="nb">cd </span>src
make <span class="nb">install</span>
</code></pre></div></div>

<p>Now you should be ready to go.</p>

<h1 id="getting-started">Getting started</h1>

<p>Download the <a href="https://drive.google.com/file/d/15wLrJphNMTuK9CXExVK9J2qYc5PS7M6C/view?usp=sharing">source file</a>. Move the <code class="language-plaintext highlighter-rouge">.tar.gz</code> archive into <code class="language-plaintext highlighter-rouge">QCB_course</code> and
untar it with</p>
<p class="prompt prompt-shell">$ tar xvzf file.tar.gz <br />
$ rm -f file.tar.gz</p>
<p>Now launch VMD:</p>
<p class="prompt prompt-shell">$ vmd</p>
<p>and you should have the following:
<img class="displayed" src="../../img/tut1/vmd.png" /></p>
<p align="center"> VMD graphical interface.</p>

<p>If everything works, close it and let’s define a common playground.</p>

<h2 id="easy-and-fast-recap">Easy and fast recap</h2>
<p>There are a lot of amino acids out there.</p>

<p><img class="displayed" src="../../img/tut1/2iolmd.jpg" alt="everywhere" /></p>

<p>But only 20 of them are coded into our DNA. We will deal mainly with these residues,
but it is not uncommon to have acetylated residues especially in the <em>termini</em>.</p>

<p>“What is a <em>terminus</em> or a residue or an amino acid?” I hear you ask.</p>

<p>Amino acids are the building block of proteins. If <em>isolated</em>, an amino acid
has an amine (-NH2)<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote">2</a></sup> and a carboxyl (-COOH) group. If <em>linked</em> with others to form
a polypeptide, they lose a hydrogen from the N-terminal (amine group) and an OH from the C-terminal (carboxyl group) and we have a residue. We will usually use <strong>residue</strong> without this distinction. <em>Ça va sans dire</em>, the first and the last residue have to be capped with the proper terminal end since they are not linked
from both sides.</p>

<p>All amino acids have a Carbon, called carbon-alpha, where a functional group is
attached. This group is specific to each amino acid and it is called <strong>sidechain</strong>,
while the other (heavy) atoms, present in each residue, constitute the <strong>backbone</strong>.</p>

<p>Below we have an <strong>Alanine</strong> with different segments highlighted that exemplifies
the nomenclature just introduced.</p>

<p><img class="displayed" src="../../img/tut1/src_img/recap_aminoacid.png" alt="amino_recap" /></p>
<div align="center">
  <p>a) Alanine amino acid in Licorice with the C-alpha shown. b) Residue of the same amino acid. <br />
c) Backbone (bottom) and sidechain (top).<br /></p>
</div>

<p>Further information will be provided as we move deep in the course.</p>

<h2 id="in-media-re-with-vmd">In media re with VMD</h2>
<p>VMD is a software for visualising and analysing molecular systems like proteins.
We will see a small subset of the available functionality of the program.
In this lesson we will focus on the visualisation of a protein and on the basics
of a scripting language called <code class="language-plaintext highlighter-rouge">Tcl</code> (read: <em>tickle</em>).</p>

<p>Let’s go back to the shell. In your working folder you should have the following files:</p>
<p class="prompt prompt-shell"> 1ubq.pdb equilibration.dcd pulling.dcd ubiquitin.psf </p>

<p>Open VMD, typing <code class="language-plaintext highlighter-rouge">vmd</code>.
We will have three windows:</p>
<ol>
  <li>VMD Main</li>
  <li>VMD Display</li>
  <li>the Terminal</li>
</ol>

<p>In the <code class="language-plaintext highlighter-rouge">VMD Display</code> our system will be draw.
<code class="language-plaintext highlighter-rouge">VMD Main</code> is a graphical interface for all the functionality we need.</p>

<p><img class="displayed" src="../../img/tut1/src_img/vmd_main.png" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">File</code>: to load molecules, render them.
<code class="language-plaintext highlighter-rouge">Molecule</code>: to perform actions on the loaded molecules.
<code class="language-plaintext highlighter-rouge">Graphics</code>: to  modify representation of the loaded structures.
<code class="language-plaintext highlighter-rouge">Display</code>: to set option for the <code class="language-plaintext highlighter-rouge">VMD Display</code>.
<code class="language-plaintext highlighter-rouge">Mouse</code>: to perform actions using the mouse.
<code class="language-plaintext highlighter-rouge">Extension</code>: contains collection of modelling and analysis tools.
<code class="language-plaintext highlighter-rouge">Help</code>: (really?).</p>

<p>Let’s load a file containing the coordinate of a protein with the extension <code class="language-plaintext highlighter-rouge">.pdb</code>.
We will load a structure of the ubiquitin, a small protein that labels proteins that have to be degraded.
So <em>File -&gt; New Molecule</em> and browse <code class="language-plaintext highlighter-rouge">1ubq.pdb</code> and load it.
You will have something like this:</p>

<p><img src="../../img/tut1/1ubq.png" alt="ubq" /></p>

<p>Now rotate the protein. Click on the <code class="language-plaintext highlighter-rouge">VMD Display</code> and press <code class="language-plaintext highlighter-rouge">r</code> and move the mouse with the left-button pressed.</p>
<p class="prompt prompt-question"> What if you press the right-button?</p>

<p>You can change the center of rotation by pressing <code class="language-plaintext highlighter-rouge">c</code> and selecting an atom as pivot.
With <code class="language-plaintext highlighter-rouge">t</code> you can translate the molecule in order to better place it in the display, while with <code class="language-plaintext highlighter-rouge">s</code> you can zoom in and out (or use the scroll button). Keep on play with it!</p>

<p>If you lose your molecule, press <code class="language-plaintext highlighter-rouge">=</code> or go to <em>Display -&gt; Reset View</em>.</p>

<p>For now we saw the protein as a bunch of lines with some red dots
overthere.</p>
<p class="prompt prompt-question">What are these dots?</p>

<p>Using the nomenclature defined above, we can modify what is displayed. Go to <em>Graphics -&gt; Representation</em> and a new window appears.</p>

<p>The representation style should be highlighted; if not, click on the line <code class="language-plaintext highlighter-rouge">Lines    Name     all</code>.
Then go to the <em>Selected Atoms</em> and write <code class="language-plaintext highlighter-rouge">protein and backbone</code>.
You should have this.</p>

<p><img src="../../img/tut1/change_select.png" alt="change_sel" /></p>

<p>Modify the <em>Drawing Method</em> from <code class="language-plaintext highlighter-rouge">Lines</code> to <code class="language-plaintext highlighter-rouge">Licorice</code>.
More keyword for the selections can be found if click on the <em>Selection</em> tab.</p>

<p><img class="displayed" src="../../img/tut1/selections.png" alt="" />
Most of the keywords will be clearer in the next lessons, so don’t be scared!</p>

<p>As you can see, you can combine keywords with <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>.</p>
<p class="prompt prompt-question">
What happens if you select <code class="language-plaintext highlighter-rouge">not protein</code>?</p>
<p>The <em>red dots</em> are water molecules whose hydrogen are not resolved by the X-rays crystallography. This is why you do not have hydrogen in your protein (the colour code for H is white).
If you change your selection into <code class="language-plaintext highlighter-rouge">water</code>, nothing should happen.</p>

<p><strong>Visualise</strong> the protein backbone and the water.</p>

<p class="prompt prompt-question">Does your selection work? If not, why?</p>

<p>You can also use more complex selections! Let’s make an example.</p>

<p>Click on the <code class="language-plaintext highlighter-rouge">VMD Display</code>, press <code class="language-plaintext highlighter-rouge">1</code> and click on a oxygen atom of water. In the <code class="language-plaintext highlighter-rouge">Terminal</code> few lines should appear. Among them
look for <code class="language-plaintext highlighter-rouge">index: XXX</code> (where <code class="language-plaintext highlighter-rouge">XXX</code> is an integer).
Go back to the <em>Graphical Representation</em> window and use <code class="language-plaintext highlighter-rouge">index XXX</code> as <em>Selected Atoms</em>. Create a new representation (<code class="language-plaintext highlighter-rouge">Create Rep</code> button) and use the following selection:
<code class="language-plaintext highlighter-rouge">same residue as within 20 of (index XXX)</code>.</p>

<p class="prompt prompt-question">What happens if you don’t write <code class="language-plaintext highlighter-rouge">same residue as</code>?</p>

<p>Usually proteins have a secondary structure: \(\alpha\)-helices, \(\beta\)-sheets etc… It’s hard to find them if we use only sticks.
Delete all the representations you have and create a new one with
the selection <code class="language-plaintext highlighter-rouge">all</code>.
Now go to <em>Drawing Method</em> and select <em>New Cartoon</em>.
In addition, change also the <em>Coloring Method</em> from <em>Name</em> into <em>Secondary Structure</em> (we are bored by the cyan colour!). The result:
<img class="displayed" src="../../img/tut1/sec_str.png" alt="" /></p>

<p>The secondary structure is inferred by the 3D arrangement of the residues and the presence of <em>h-bonds</em>, a non covalent bond between a donor (a heavy electronegative atom with a Hydrogen, usually <code class="language-plaintext highlighter-rouge">O-H</code>, <code class="language-plaintext highlighter-rouge">N-H</code>, <code class="language-plaintext highlighter-rouge">F-H</code>) and an acceptor (same kind of atoms not covalently bonded to the Hydrogen) and it is established upon geometric criteria.</p>

<p>Here the colouring scheme for the secondary structure.</p>

<p><img class="displayed" src="../../img/tut1/vmd_struct.png" alt="" /></p>
<ul>
  <li>T = hydrogen bonded turn (3, 4 or 5 turn)</li>
  <li>E = extended strand in parallel and/or anti-parallel β-sheet conformation.</li>
  <li>B = residue in isolated β-bridge (single pair β-sheet hydrogen bond formation)</li>
  <li>H = 4-turn helix (α helix).</li>
  <li>G = 3-turn helix (3<sub>10</sub> helix)</li>
  <li>I = 5-turn helix (π helix)</li>
  <li>C = coil (residues which are not in any of the above conformations).</li>
</ul>

<p>Now keep on playing with the colouring methods and representations. But <strong>before</strong> go to <em>Extension -&gt; Visualization -&gt; ViewMaster</em>. Click on <code class="language-plaintext highlighter-rouge">Create New</code>, so you have a representation to go back if you change too many things and you
are not pleased with it.</p>

<p>The choice of the settings depends on what you want to convey with your image.
Once you are happy we can (and will) do two things:</p>
<ol>
  <li>save our work, so we can reload the representation for future use;</li>
  <li>render and save a picture.</li>
</ol>

<p>To <u>save the representation</u>, click on <em>File -&gt; Save Visualization State</em>, write a name for the file (usually with a <code class="language-plaintext highlighter-rouge">.vmd</code> extension) and save it.</p>

<p>Now quit VMD and reload the representation with <em>File -&gt; Load Visualization State</em>.</p>

<p>Let’s now <u>render</u>.
First of all, we need to change the backgound colour since black is not suitable for printing.
So go to <em>Graphics -&gt; Colors..</em> and change the <em>Display Backgound</em> in <code class="language-plaintext highlighter-rouge">white</code>.</p>

<p>Then remove the axis: <em>Display -&gt; Axes -&gt; off</em>.</p>

<p>Probably your image is a bit pale. This is due to the <code class="language-plaintext highlighter-rouge">Depth Cueing</code>. Go to <em>Display -&gt; Depth Cueing -&gt; off</em>.
If now it is too dark, turn the cuing on again and modify the parameter in <em>Display -&gt; Display Settings…</em> and change the <em>Cueing Mode</em> in <code class="language-plaintext highlighter-rouge">Linear</code>. You can also play with the related parameters.</p>

<p>Now if you go to <em>File -&gt; Render -&gt; Snapshot</em> and <em>Start Render</em>,
 you create an image.
 Depending on your system, something will happen.</p>

<p>But, in general, the image has a pretty low quality. Let’s improve it!</p>

<p>First, in <em>Graphics -&gt; Representation</em> you can increase the resolution of each representation you have.
 Then, change the <em>Material</em> in <em>AOChalky</em>.
 Finally go back to the rendering window and change the rendering engine in <em>Tachyon</em>.</p>

<p><img class="displayed" src="../../img/tut1/render.png" alt="" /></p>

<h2 id="tcl-scripting">Tcl scripting</h2>
<p>A feature of VMD is the presence of a <code class="language-plaintext highlighter-rouge">Tcl/Tk console</code>.
Every thing that you can do with the graphical interface can be
done with the command line.</p>

<p>To open the console go to <em>Extension -&gt; Tcl/tk console</em> and a new window pops up.</p>

<p>Just to see if my previous statement was correct, let’s type:</p>
<p class="prompt prompt-tk">
% color Display Background black <br />
</p>
<p>Did something happen?</p>

<p>Let’s move to the tcl basics:</p>
<ul>
  <li>to define a variable <code class="language-plaintext highlighter-rouge">set a 4</code>;</li>
  <li>to print the variable value <code class="language-plaintext highlighter-rouge">puts $a</code>.</li>
</ul>

<p>Note that to access the variable value you have to use the dollar sign <code class="language-plaintext highlighter-rouge">$</code>.</p>

<p>You can also print strings:</p>
<p class="prompt prompt-tk">% puts “Hello, World! &gt;.&lt;” </p>

<p>Of course you can do simple arithmetics as below:</p>
<p class="prompt prompt-tk">
% expr 3 * 10 <br />
% expr $a + 5 <br />
 </p>
<p>To evaluate an instruction and assign its output to a variable you need  to enclose the command into square brackets <code class="language-plaintext highlighter-rouge">[  ]</code>.</p>
<p class="prompt prompt-tk">
% set a [expr $a * 13.4] <br />
 </p>

<p>Common statements you will use are:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">for</code> loop:</li>
</ul>
<p class="prompt prompt-tk">
% for {set i 0} {$i &lt; 10} {incr i} { <br />
    puts “$i plus 1:\t[expr $i + 1]”  <br />
} </p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">if</code> clause:</li>
</ul>
<p class="prompt prompt-tk">
% if { 10 &gt; 4 } { <br />
    puts –nonewline “True “ <br />
    puts “statement!” <br />
} </p>

<p>Let’s check some VMD-specific commands. First let’s resize the display.</p>
<p class="prompt prompt-tk">% display resize 600 600 </p>
<p>This is not the only  We saw already how to resize the display. For further info the <code class="language-plaintext highlighter-rouge">display</code> command, type:</p>
<p class="prompt prompt-tk">% display </p>
<p>The <em>help</em> will be prompted out in red.
You don’t need to memorise all the commands!</p>
<p class="prompt prompt-attention">Read the output/errors! They are really useful to understand that happens.</p>

<p>Check what <code class="language-plaintext highlighter-rouge">molinfo</code> and <code class="language-plaintext highlighter-rouge">atomselect</code> do.</p>

<p>Suppose we want to compute the number of residue in our protein.</p>

<p>First, we need to make a selection of the protein.</p>
<p class="prompt prompt-attention">Can you think about one atom present in all the residues?</p>

<p class="prompt prompt-tk">
% set selection [atomselect top “ Selection-here “] <br />
% $selection num </p>

<p>Let’s finally clear the workspace.</p>
<p class="prompt prompt-tk">% mol delete all </p>

<h2 id="trajectories">Trajectories</h2>
<p>The output of an MD simulation is a trajectory. Let’s see what VMD can do with it.</p>

<h1 id="equilibration">Equilibration</h1>

<p>Load the <code class="language-plaintext highlighter-rouge">ubiquitin.psf</code> (a Protein Structure File), then right-click on the brand new molecule and select <code class="language-plaintext highlighter-rouge">Load Data Into Molecule</code>. Here you have to select the <code class="language-plaintext highlighter-rouge">equilibration.dcd</code> (a trajectory file in binary) and <code class="language-plaintext highlighter-rouge">load all at once</code>.</p>

<p>In the <em>VMD Main</em> you can play with the trajectory.</p>

<p>The ubiquitin wobbles a bit around. So let align all the frames in order to have the protein almost in the same position.
How many frames do we have?</p>
<p class="prompt prompt-tk">molinfo top get numframes</p>

<p>Let’s comment the following script.</p>
<p class="prompt prompt-tk">
% set nf [molinfo top get numframes] <br />
% set all [atomselect top “all”] <br />
% set ref_0 [atomselect top “protein and name CA” frame 0] <br />
% set ref [atomselect top “protein and name CA”] <br />
% for {set f 0 } {$f &lt; $nf} {incr f} { <br />
      $ref frame $f <br />
      $all frame $f <br />
      set M [measure fit $ref $ref_0] <br />
      $all move $M <br />
} </p>

<p>Now we should have the protein almost in the same position for the whole trajectory. But still, the <em>movie</em> is not smooth.</p>

<p>In <em>Graphics -&gt; Representation</em> there is a tab we previously ignored: <em>Trajectory</em>.</p>

<p><img class="displayed" src="../../img/tut1/smooth_trj.png" alt="" /></p>

<p>Here we can play with the <em>Trajectory Smoothing Window Size</em>.
VMD will perform a rolling average of the positions of the atoms
(therefore we would see something weird if we use licorice, such as wrong methyl group arrangement.)
The smoothing is applied to the representation is set. So if you have multiple reprs, check this option carefully.</p>

<h1 id="measuring-quantities">Measuring quantities</h1>

<p>We used the command <code class="language-plaintext highlighter-rouge">measure</code> few lines ago. To have an idea of what you can actually <em>measure</em>, just type <code class="language-plaintext highlighter-rouge">measure</code> in the <code class="language-plaintext highlighter-rouge">Tcl/tk console</code>.</p>

<p>As an example, let’s compute the radius of gyration of our protein:</p>

\[R_g^2 = \frac{\sum_{i=1}^{N} m_i (\vec{r}_i - \vec{r}_{CM})^2 }{\sum_{i=1}^N m_i}\]

<p>It is a quantity that tells you how compact your protein is.
In VMD there are primitives you can use to measure properties of your system and combine them to do deeper and fancier analysis.</p>

<p>The command we look for is <code class="language-plaintext highlighter-rouge">measure rgyr</code>.
Type:</p>
<p class="prompt prompt-tk">
% set calpha [atomselect top “alpha”] <br />
% measure rgyr $calpha</p>

<p>Now compute with a script the radius of gyration for all the frames and save it into a file <code class="language-plaintext highlighter-rouge">my_first_script.tcl</code></p>
<p class="prompt prompt-tk"> Solution not available  ;) <br /> </p>

<p>Let’s improve our script by printing the results into a file. We will need to add a command to open a writeable file:</p>
<p class="prompt prompt-tk"> set output_file [open ‘eq_rgyr.dat’ w] </p>
<p>and modify the <code class="language-plaintext highlighter-rouge">puts</code> command with:</p>
<p class="prompt prompt-tk">
puts $output_file ‘$f\t$rgyr’ </p>
<p>and, finally, we have to close the file:</p>
<p class="prompt prompt-tk"> close $output_file </p>

<p>We can plot the data using <code class="language-plaintext highlighter-rouge">gnuplot</code> (type it in a new shell), and then:</p>
<p class="prompt prompt-shell"> p “eq_rgyr.dat” w l </p>

<p>To quit from <code class="language-plaintext highlighter-rouge">gnuplot</code>, type <code class="language-plaintext highlighter-rouge">q</code> and <code class="language-plaintext highlighter-rouge">Enter</code>.</p>

<p><strong>Bonus</strong>: What does pressing <code class="language-plaintext highlighter-rouge">2</code>, <code class="language-plaintext highlighter-rouge">3</code>, <code class="language-plaintext highlighter-rouge">4</code> in the <code class="language-plaintext highlighter-rouge">VMD Display</code> do?</p>

<h1 id="pulling">Pulling</h1>

<p>Let’s clear the workspace again <code class="language-plaintext highlighter-rouge">mol delete all</code> and load the <code class="language-plaintext highlighter-rouge">pulling.dcd</code> by using:</p>
<p class="prompt prompt-tk">
mol new ubiquitin.psf <br />
mol addfile pulling.dcd waitfor all </p>

<p>In this simulation, one end of the protein is pulled, while another atom is kept fixed. It can be a way to unfold a protein.</p>

<p>Play the trajectory to see what happens.</p>

<p>You can visualise multiple frames at ones. To do so,
switch the representation to <code class="language-plaintext highlighter-rouge">New Cartoon</code> and in the <em>Trajectory</em> tab modify the <em>Draw Multiple Frames</em> from <code class="language-plaintext highlighter-rouge">now</code> to
<code class="language-plaintext highlighter-rouge">0:10:99</code>. Modify now the colouring method in <code class="language-plaintext highlighter-rouge">Trajectory -&gt; Timestep</code>.</p>

<p><img class="displayed" src="../../img/tut1/multiple_frame.png" alt=" " /></p>

<p>Now,  go to frame <code class="language-plaintext highlighter-rouge">0</code> and create two representation to
 visualise water molecules around the protein.
<u>For the protein</u>: colour the secondary structure and use <code class="language-plaintext highlighter-rouge">New Cartoon</code>
<u>For the water</u>: select water residues within 3 of protein with a <code class="language-plaintext highlighter-rouge">VDW</code> <em>Draw Style</em>.
Play the trajectory now.</p>
<p class="prompt prompt-attention">Do your water molecule have three atoms?</p>
<p class="prompt prompt-attention">Is it the result you expect? </p>

<p>Go in the <em>Trajectory</em> tab and select <em>Update Selection Every Frame</em> and replay the trajectory.</p>
<p class="prompt prompt-attention">Did something change?</p>

<p>Finally, we can modify <code class="language-plaintext highlighter-rouge">my_first_script.tcl</code> in order to apply it to this new trajectory.</p>
<ol>
  <li>Change the output file name;</li>
  <li>launch the script with <code class="language-plaintext highlighter-rouge">source my_first_script.tcl</code></li>
</ol>

<p>Now plot the two radius of gyration.</p>

<h2 id="exercise">Exercise</h2>

<p>Downlod a structure from the <a href="https://www.rcsb.org/">Protein Data Bank</a> and download a molecule you like (or ask for hints).</p>

<p>Create your custom representation of the protein, highlighting a particular residue in <code class="language-plaintext highlighter-rouge">Licorice</code>, ligands in <code class="language-plaintext highlighter-rouge">Licorice</code> or <code class="language-plaintext highlighter-rouge">VDW</code>.</p>

<h2 id="bonus">Bonus</h2>
<p>If you manage to complete the exercise, ask for a really small task.</p>

<h1 id="further-readings">Further readings</h1>
<ol>
  <li><a href="https://www.ks.uiuc.edu/Research/vmd/current/ug.pdf">VMD User’s Guide</a></li>
</ol>

<hr />
<h1 id="notes">Notes</h1>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>This tutorial is adapted from <a href="https://www.ks.uiuc.edu/Training/Tutorials/vmd/vmd-tutorial.pdf">Using VMD</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>Under biological conditions, the N-group is protonated (-NH3+) <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
:ET